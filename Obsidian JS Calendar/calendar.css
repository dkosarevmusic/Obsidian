.ojsc-container {
    width: 100%;
    margin-top: 20px; /* Добавляем отступ сверху, чтобы выпадающий список не обрезался */
}
.ojsc-footer {
    text-align: right;
    font-size: 0.8em;
    color: var(--text-muted);
    margin-top: 10px;
    padding-right: 5px;
}

.ojsc-calendar-header { 
    display: flex; 
    flex-direction: column; /* Заголовок и контролы теперь в столбце */
    align-items: stretch; /* Растягиваем на всю ширину */
    margin-bottom: 5px; 
    gap: 8px; /* Отступ между заголовком и панелью управления */
    padding: 8px 12px; 
    background-color: var(--background-secondary); 
    border-radius: 6px; 
}
.ojsc-controls-wrapper { display: flex; justify-content: space-between; align-items: center; gap: 10px; }
.ojsc-main-nav-group, .ojsc-view-controls-group { 
    display: flex; 
    gap: 5px; 
    align-items: center; /* Главное правило для вертикального выравнивания */
}
.ojsc-calendar-header select, .ojsc-calendar-header button { 
    background-color: var(--background-modifier-form-field); 
    color: var(--text-normal); 
    border: 1px solid var(--background-modifier-border); 
    border-radius: 4px; 
    padding: 4px 8px; 
    height: 32px;
    box-sizing: border-box;
}
.ojsc-calendar-header select {
    text-align: center;
    text-align-last: center;
}
.ojsc-calendar-header h2 { margin: 0; text-transform: capitalize; color: white; text-align: center; }
.ojsc-multi-month-header { 
    text-align: center; 
    text-transform: capitalize; 
    margin-top: 20px; 
    margin-bottom: 5px; 
    background-color: var(--background-secondary);
    color: var(--text-accent) !important;
    padding: 6px 0;
    border-radius: 6px;
}
/* Убираем верхний отступ у самого первого заголовка месяца в многомесячных видах */
.ojsc-multi-month-header:first-of-type {
    margin-top: 0;
}

.ojsc-day-card {
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    /* Возвращаем небольшой боковой отступ для общего вида, но будем его компенсировать. */
    padding: 8px 4px;
    background-color: var(--background-secondary);
    flex: 1;
    min-width: 0; /* Предотвращает переполнение контентом */
    display: flex;
    flex-direction: column;
}
.ojsc-day-card.ojsc-today {
    border-color: var(--text-accent);
}
.ojsc-day-card.ojsc-drop-target {
    background-color: var(--background-modifier-hover);
    border-style: solid;
    border-color: var(--text-accent);
}
.ojsc-day-card-header {
    font-weight: bold;
    margin-bottom: 4px;
    /* Заголовку теперь нужен меньший отступ, так как у родителя есть свой. */
    padding: 0 4px;
}
.ojsc-day-card .ojsc-task-list {
    list-style: none;
    padding: 0;
    /* Используем отрицательный margin, чтобы "выйти" за пределы padding родителя.
       Это позволяет списку задач занимать всю ширину, убирая лишний отступ слева. */
    margin: 4px -4px 0 -4px;
    font-size: 0.9em;
}
.ojsc-day-card .ojsc-task-item {
    margin-bottom: 4px;
    /* Устанавливаем симметричные отступы для текста внутри задачи. */
    /* Уменьшаем отрицательный отступ, чтобы сдвинуть элемент немного правее. */
    margin-left: 4px;
    /* Добавляем внешний отступ справа, чтобы сдвинуть правый край плашки левее. */
    margin-right: 4px;
    padding: 1px 3px;
    border-radius: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
/* Стиль для элемента, который перетаскивается на мобильных */
.ojsc-task-item.ojsc-dragging {
    opacity: 0.5; /* Оставляем только полупрозрачность для консистентности */
    /* border-style: dashed; - Убираем пунктирную рамку */
}
/* Стиль для подсветки "важных" задач. Накладывается поверх цвета Area. */
.ojsc-task-item.ojsc-task-item-important {
    /* Добавляем красную рамку справа, чтобы не конфликтовать с рамкой Area слева */
    box-shadow: inset -3px 0 0 hsl(0, 80%, 50%);
    /* Можно добавить и полупрозрачный фон, если нужно более сильное выделение */
    /* background-image: linear-gradient(to right, hsla(0, 80%, 50%, 0.1), hsla(0, 80%, 50%, 0.1)); */
}
/* Стиль для задачи в процессе сохранения после переноса */
.ojsc-task-item-saving {
    position: relative; /* Необходимо для позиционирования псевдо-элемента */
    z-index: 1; /* Убедимся, что элемент находится над другими */
}

.ojsc-task-item-saving::before {
    content: '';
    position: absolute;
    /* Сдвигаем вспышку на 3px влево, чтобы не перекрывать цветную границу задачи */
    top: 0; left: 3px; right: 0; bottom: 0;
    background-color: white;
    border-radius: 4px; /* Такой же, как у самой задачи */
    opacity: 0;
    animation: ojsc-flash 1.2s infinite ease-out;
    z-index: 2; /* Псевдо-элемент должен быть над текстом задачи */
}

@keyframes ojsc-flash {
    0% { opacity: 0; }
    20% { opacity: 0.7; } /* Пик вспышки */
    100% { opacity: 0; }
}

/* Стили для сеток (месяц, год) */
.ojsc-month-container { margin-bottom: 20px; }
.ojsc-weekdays-header {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px; /* Отступ между плашками */
    margin-bottom: 5px;
}
.ojsc-weekday {
    background-color: var(--background-secondary);
    color: var(--text-muted);
    padding: 4px 0;
    border-radius: 4px;
    text-align: center;
    font-size: 0.85em;
    font-weight: 600;
}
.ojsc-weekday.ojsc-weekend {
    color: var(--text-accent);
}
.ojsc-month-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px;
}
.ojsc-month-grid-card {
    min-height: 100px;
    padding: 4px;
}
.ojsc-month-grid-card .ojsc-day-card-header {
    font-size: 0.9em;
    text-align: right;
}
.ojsc-month-grid-card.ojsc-other-month {
    opacity: 0.5;
}
/* Индикация текущего дня в сеточных видах (месяц, год).
   Вместо круга, который влияет на размер ячейки, просто выделяем цифру цветом и жирностью. */
.ojsc-today-number {
    color: var(--text-accent);
    font-weight: 700; /* Делаем цифру жирнее для акцента */
    padding: 0 2px; /* Небольшой отступ, чтобы не прилипало к краю */
}
.ojsc-clickable-day {
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    border-radius: 4px;
    background-color: var(--background-modifier-form-field); /* Постоянное выделение */
    margin: -2px; /* Компенсируем padding родителя, чтобы ховер был красивее */
    padding: 2px; /* Возвращаем внутренний отступ */
}
.ojsc-clickable-day:hover {
    background-color: var(--background-modifier-hover);
}

/* --- Кастомные сдвиги для разных режимов --- */
/* Для месячного вида, компенсируем padding: 4px у .ojsc-month-grid-card */
.ojsc-month-grid .ojsc-task-item {
    margin-left: 4px; /* Сдвиг вправо на 1px */
}

/* --- Адаптивность для мобильных устройств --- */
@media (max-width: 650px) {
    .ojsc-controls-wrapper {
        flex-direction: column; /* Все контролы в столбец */
        gap: 8px;
    }
    .ojsc-view-controls-group {
        order: 2; /* Селекторы идут после кнопок навигации */
        justify-content: center; /* Центрируем селекторы */
    }
    .ojsc-main-nav-group {
        order: 1; /* Кнопки навигации идут первыми под заголовком */
        justify-content: space-between; /* Распределяем кнопки по ширине */
    }
}

/* Day card header color coding for task areas */

/* For grid views (month, year) - "clickable plates" */
.ojsc-day-work .ojsc-clickable-day {
    box-shadow: inset 0 3px 0 0 hsl(30, 100%, 50%);
}

.ojsc-day-skills .ojsc-clickable-day {
    box-shadow: inset 0 3px 0 0 hsl(220, 100%, 50%);
}

.ojsc-day-art .ojsc-clickable-day {
    box-shadow: inset 0 3px 0 0 hsl(280, 100%, 50%);
}

/* For 1-day view header */
.ojsc-day-work .ojsc-day-card-header:not(.ojsc-clickable-day) {
    border-top: 3px solid hsl(30, 100%, 50%);
    padding-top: 3px; /* Add padding to prevent text from touching the line */
}
.ojsc-day-skills .ojsc-day-card-header:not(.ojsc-clickable-day) {
    border-top: 3px solid hsl(220, 100%, 50%);
    padding-top: 3px;
}
.ojsc-day-art .ojsc-day-card-header:not(.ojsc-clickable-day) {
    border-top: 3px solid hsl(280, 100%, 50%);
    padding-top: 3px;
}

/* --- Time Toggle Feature Styles --- */

/* Active state for the 'Time' button */
.ojsc-calendar-header button.ojsc-button-active {
    background-color: var(--text-accent);
    color: var(--text-on-accent);
    border-color: var(--text-accent);
}

/* Layout for tasks with time to stack time and text */
.ojsc-task-with-time .internal-link {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
}

/* Style for the task time text */
.ojsc-task-time {
    color: var(--text-accent);
    font-weight: 500;
}